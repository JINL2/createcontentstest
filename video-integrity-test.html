<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Integrity Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        video {
            width: 100%;
            max-width: 400px;
            height: auto;
            background: #000;
        }
        .star-rating {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        .star {
            font-size: 30px;
            cursor: pointer;
            color: #ddd;
            transition: all 0.2s;
        }
        .star.active {
            color: #ffd700;
        }
        .star.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.error {
            background: #ffebee;
            color: #c62828;
        }
        .status.success {
            background: #e8f5e9;
            color: #2e7d32;
        }
        .status.info {
            background: #e3f2fd;
            color: #1565c0;
        }
        .test-results {
            background: #263238;
            color: #fff;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
        }
        button {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #e55a2b;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Video Integrity Test</h1>

    <!-- Test Case 1: ì •ìƒ ë¹„ë””ì˜¤ -->
    <div class="test-case">
        <h2>Test 1: ì •ìƒ ë¹„ë””ì˜¤ (ë¬´ê²°ì„± ì²´í¬ ì‘ë™)</h2>
        <video id="video1" controls>
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
        </video>
        <div class="star-rating" id="rating1">
            <span class="star disabled" data-rating="1">â­</span>
            <span class="star disabled" data-rating="2">â­</span>
            <span class="star disabled" data-rating="3">â­</span>
            <span class="star disabled" data-rating="4">â­</span>
            <span class="star disabled" data-rating="5">â­</span>
        </div>
        <div id="status1" class="status info">ë¹„ë””ì˜¤ë¥¼ 3ì´ˆ ì´ìƒ ì¬ìƒí•´ì£¼ì„¸ìš”</div>
        <div>ì¬ìƒ ì‹œê°„: <span id="playTime1">0</span>ì´ˆ</div>
    </div>

    <!-- Test Case 2: ì˜ëª»ëœ URL -->
    <div class="test-case">
        <h2>Test 2: ì˜ëª»ëœ URL (ì—ëŸ¬ ì²˜ë¦¬)</h2>
        <video id="video2" controls>
            <source src="https://example.com/non-existent-video.mp4" type="video/mp4">
        </video>
        <div class="star-rating" id="rating2">
            <span class="star disabled" data-rating="1">â­</span>
            <span class="star disabled" data-rating="2">â­</span>
            <span class="star disabled" data-rating="3">â­</span>
            <span class="star disabled" data-rating="4">â­</span>
            <span class="star disabled" data-rating="5">â­</span>
        </div>
        <div id="status2" class="status info">ë¹„ë””ì˜¤ ë¡œë“œ ëŒ€ê¸°ì¤‘...</div>
    </div>

    <!-- Test Case 3: ê°•ì œ í‰ê°€ ì‹œë„ -->
    <div class="test-case">
        <h2>Test 3: ê°•ì œ í‰ê°€ ì‹œë„ (í•´í‚¹ ë°©ì§€)</h2>
        <button onclick="forceRating()">ê°•ì œë¡œ í‰ê°€ ì‹œë„ (í•´í‚¹)</button>
        <div id="hackResult" class="status info">ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…ŒìŠ¤íŠ¸</div>
    </div>

    <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ -->
    <div class="test-case">
        <h2>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
        <div class="test-results" id="testResults">
í…ŒìŠ¤íŠ¸ ë¡œê·¸:
- í˜ì´ì§€ ë¡œë“œë¨...
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒíƒœ
        let videoStates = {
            video1: { loaded: false, playTime: 0, minWatchTime: 3 },
            video2: { loaded: false, playTime: 0, minWatchTime: 3 }
        };

        // ë¡œê·¸ í•¨ìˆ˜
        function log(message) {
            const results = document.getElementById('testResults');
            results.innerHTML += `\n- ${new Date().toLocaleTimeString()}: ${message}`;
            results.scrollTop = results.scrollHeight;
        }

        // Test 1: ì •ìƒ ë¹„ë””ì˜¤
        const video1 = document.getElementById('video1');
        const rating1Stars = document.querySelectorAll('#rating1 .star');
        let playTimer1 = null;

        video1.addEventListener('loadedmetadata', () => {
            log('Video 1: ë©”íƒ€ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
            videoStates.video1.loaded = true;
        });

        video1.addEventListener('play', () => {
            log('Video 1: ì¬ìƒ ì‹œì‘');
            playTimer1 = setInterval(() => {
                videoStates.video1.playTime++;
                document.getElementById('playTime1').textContent = videoStates.video1.playTime;
                
                if (videoStates.video1.playTime >= videoStates.video1.minWatchTime) {
                    // í‰ê°€ í™œì„±í™”
                    rating1Stars.forEach(star => star.classList.remove('disabled'));
                    document.getElementById('status1').className = 'status success';
                    document.getElementById('status1').textContent = 'âœ… í‰ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤!';
                    log('Video 1: í‰ê°€ í™œì„±í™”ë¨ (3ì´ˆ ì‹œì²­ ì™„ë£Œ)');
                    clearInterval(playTimer1);
                }
            }, 1000);
        });

        video1.addEventListener('pause', () => {
            if (playTimer1) clearInterval(playTimer1);
            log('Video 1: ì¼ì‹œì •ì§€');
        });

        video1.addEventListener('error', (e) => {
            log(`Video 1: ì—ëŸ¬ ë°œìƒ - ${e.message}`);
            document.getElementById('status1').className = 'status error';
            document.getElementById('status1').textContent = 'âŒ ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨';
        });

        // Test 2: ì˜ëª»ëœ URL
        const video2 = document.getElementById('video2');
        
        video2.addEventListener('error', (e) => {
            log('Video 2: ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨ (ì˜ˆìƒëœ ê²°ê³¼)');
            document.getElementById('status2').className = 'status error';
            document.getElementById('status2').textContent = 'âŒ ë¹„ë””ì˜¤ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤';
            
            // í‰ê°€ ë²„íŠ¼ì€ ê³„ì† ë¹„í™œì„±í™” ìƒíƒœ
            const rating2Stars = document.querySelectorAll('#rating2 .star');
            rating2Stars.forEach(star => {
                star.style.pointerEvents = 'none';
                star.title = 'ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨ë¡œ í‰ê°€ ë¶ˆê°€';
            });
        });

        // ë³„ì  í´ë¦­ ì´ë²¤íŠ¸
        document.querySelectorAll('#rating1 .star').forEach(star => {
            star.addEventListener('click', function() {
                if (this.classList.contains('disabled')) {
                    alert('âŒ ë¹„ë””ì˜¤ë¥¼ 3ì´ˆ ì´ìƒ ì‹œì²­í•´ì•¼ í‰ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!');
                    log('Video 1: í‰ê°€ ì‹œë„ ê±°ë¶€ë¨ (ì‹œì²­ ì‹œê°„ ë¶€ì¡±)');
                    return;
                }
                
                const rating = this.dataset.rating;
                log(`Video 1: ${rating}ì  í‰ê°€ ì™„ë£Œ`);
                alert(`âœ… ${rating}ì  í‰ê°€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                
                // ë³„ì  í•˜ì´ë¼ì´íŠ¸
                document.querySelectorAll('#rating1 .star').forEach((s, i) => {
                    if (i < rating) {
                        s.classList.add('active');
                    }
                });
            });
        });

        // Test 3: ê°•ì œ í‰ê°€ ì‹œë„
        function forceRating() {
            log('í•´í‚¹ ì‹œë„: ê°•ì œ í‰ê°€ í•¨ìˆ˜ í˜¸ì¶œ');
            
            // ì‹¤ì œ video-review.jsì˜ ë¡œì§ì²˜ëŸ¼ ì²´í¬
            if (!videoStates.video1.loaded || videoStates.video1.playTime < videoStates.video1.minWatchTime) {
                document.getElementById('hackResult').className = 'status error';
                document.getElementById('hackResult').textContent = 'âŒ ë¬´ê²°ì„± ì²´í¬ ì‹¤íŒ¨! í‰ê°€ê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.';
                log('í•´í‚¹ ì‹œë„ ì‹¤íŒ¨: ë¬´ê²°ì„± ì²´í¬ì— ê±¸ë¦¼');
            } else {
                document.getElementById('hackResult').className = 'status success';
                document.getElementById('hackResult').textContent = 'âœ… ì •ìƒì ì¸ í‰ê°€ (ë¹„ë””ì˜¤ë¥¼ ì¶©ë¶„íˆ ì‹œì²­í•¨)';
                log('ì •ìƒ í‰ê°€: ë¬´ê²°ì„± ì²´í¬ í†µê³¼');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            log('ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ');
        });
    </script>
</body>
</html>